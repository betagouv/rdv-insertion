<% if max_number_of_invitations_for_a_format == 0 %>
  <tr>
    <% invitation_formats.each do |format| %>
      <td class="px-4 py-3">-</td>
    <% end %>
  </tr>
<% else %>
  <% max_number_of_invitations_for_a_format.times do |idx| %>
    <tr class="<%= idx == 0 ? "motif-category-#{motif_category.id}-last-invitations" : "d-none motif-category-#{motif_category.id}-other-invitations" %>">
      <% invitation_formats.each do |format| %>
        <td class="px-4 py-3">
          <% if invitation_dates_by_format[format]&.fetch(idx, nil).present? %>
            <%= format_date(invitation_dates_by_format[format].fetch(idx, nil)) %>
            <% delivery_status = invitation_delivery_status_by_format[format].fetch(idx, nil)%>
            <div>
              <span class="small">
                <% if delivery_status == "Non délivrée" %>
                <span class="text-danger">
                  Non délivrée
                  <i
                    class="fas fa-exclamation-circle"
                    data-controller="tooltip"
                    data-action="mouseover->tooltip#invitationNotDelivered"
                    data-invitation-format="<%= format %>">
                  </i>
                </span>
                <% else %>
                  <%= delivery_status %>
                <% end %>
              </span>
            </div>
          <% elsif idx == 0 %>
            -
          <% end %>
        </td>
      <% end %>
    </tr>
  <% end %>
<% end %>
